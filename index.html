<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Mantenimientos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 900px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
        }

        header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .app-content {
            display: flex;
            min-height: 500px;
        }

        .form-section {
            flex: 1;
            padding: 25px;
            background: #f8f9fa;
        }

        .preview-section {
            flex: 1;
            padding: 25px;
            background: white;
            border-left: 1px solid #eee;
            display: flex;
            flex-direction: column;
        }

        .section-title {
            font-size: 18px;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #34495e;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 15px;
            transition: all 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .camera-options {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-success {
            background: #2ecc71;
            color: white;
        }

        .btn-success:hover {
            background: #27ae60;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .signature-pad {
            width: 100%;
            height: 150px;
            border: 1px solid #ddd;
            border-radius: 6px;
            margin-bottom: 15px;
            background: white;
            touch-action: none;
            cursor: crosshair;
        }

        .preview-content {
            flex: 1;
            overflow-y: auto;
        }

        .preview-item {
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .preview-item h3 {
            font-size: 16px;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .preview-image {
            width: 100%;
            max-height: 200px;
            object-fit: contain;
            border-radius: 4px;
            margin-top: 10px;
            border: 1px solid #ddd;
        }

        .signature-preview {
            width: 100%;
            height: 80px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            margin-top: 10px;
        }

        .actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .actions .btn {
            flex: 1;
        }

        .datetime {
            font-size: 14px;
            color: #7f8c8d;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            .app-content {
                flex-direction: column;
            }
            
            .preview-section {
                border-left: none;
                border-top: 1px solid #eee;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-tools"></i> Registro de Mantenimientos</h1>
            <p>Control de equipos de cómputo e impresoras</p>
        </header>
        
        <div class="app-content">
            <div class="form-section">
                <h2 class="section-title">Datos del Mantenimiento</h2>
                
                <div class="form-group">
                    <label for="equipmentType">Tipo de Equipo *</label>
                    <select id="equipmentType" required>
                        <option value="">Seleccione el tipo de equipo</option>
                        <option value="computadora">Computadora</option>
                        <option value="laptop">Laptop</option>
                        <option value="impresora">Impresora</option>
                        <option value="servidor">Servidor</option>
                        <option value="monitor">Monitor</option>
                        <option value="otros">Otros</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="equipmentId">Número de Serie/Identificación *</label>
                    <input type="text" id="equipmentId" placeholder="ID del equipo" required>
                </div>
                
                <div class="form-group">
                    <label for="maintenanceType">Tipo de Mantenimiento *</label>
                    <select id="maintenanceType" required>
                        <option value="">Seleccione el tipo de mantenimiento</option>
                        <option value="preventivo">Preventivo</option>
                        <option value="correctivo">Correctivo</option>
                        <option value="actualizacion">Actualización</option>
                        <option value="reparacion">Reparación</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="description">Descripción del Mantenimiento</label>
                    <textarea id="description" placeholder="Describa el trabajo realizado..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="responsible">Encargado del Mantenimiento *</label>
                    <input type="text" id="responsible" placeholder="Nombre del responsable" required>
                </div>
                
                <div class="form-group">
                    <label>Fecha y Hora</label>
                    <div id="datetime" class="datetime">Cargando...</div>
                </div>
                
                <div class="form-group">
                    <label>Fotografía del Equipo</label>
                    <div class="camera-options">
                        <button class="btn btn-primary" id="captureBtn">
                            <i class="fas fa-camera"></i> Tomar Foto
                        </button>
                        <button class="btn btn-primary" id="uploadBtn">
                            <i class="fas fa-upload"></i> Subir Foto
                        </button>
                    </div>
                    <input type="file" id="photoUpload" accept="image/*" style="display: none;">
                </div>
                
                <div class="form-group">
                    <label>Firma del Encargado</label>
                    <div class="signature-pad" id="signaturePad"></div>
                    <button class="btn btn-danger" id="clearSignature">
                        <i class="fas fa-eraser"></i> Limpiar Firma
                    </button>
                </div>
                
                <div class="actions">
                    <button class="btn btn-success" id="saveBtn">
                        <i class="fas fa-save"></i> Guardar Registro
                    </button>
                    <button class="btn btn-danger" id="resetBtn">
                        <i class="fas fa-trash"></i> Limpiar Formulario
                    </button>
                </div>
            </div>
            
            <div class="preview-section">
                <h2 class="section-title">Vista Previa</h2>
                <div class="preview-content" id="previewContent">
                    <div class="preview-item">
                        <h3>Datos del Equipo</h3>
                        <div id="previewEquipment">No seleccionado</div>
                    </div>
                    
                    <div class="preview-item">
                        <h3>Detalles del Mantenimiento</h3>
                        <div id="previewMaintenance">No seleccionado</div>
                    </div>
                    
                    <div class="preview-item">
                        <h3>Encargado</h3>
                        <div id="previewResponsible">No especificado</div>
                    </div>
                    
                    <div class="preview-item">
                        <h3>Fotografía</h3>
                        <div id="previewPhoto">No hay foto</div>
                    </div>
                    
                    <div class="preview-item">
                        <h3>Firma</h3>
                        <div id="previewSignature">No hay firma</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elementos del DOM
            const equipmentType = document.getElementById('equipmentType');
            const equipmentId = document.getElementById('equipmentId');
            const maintenanceType = document.getElementById('maintenanceType');
            const description = document.getElementById('description');
            const responsible = document.getElementById('responsible');
            const datetime = document.getElementById('datetime');
            const captureBtn = document.getElementById('captureBtn');
            const uploadBtn = document.getElementById('uploadBtn');
            const photoUpload = document.getElementById('photoUpload');
            const signaturePad = document.getElementById('signaturePad');
            const clearSignature = document.getElementById('clearSignature');
            const saveBtn = document.getElementById('saveBtn');
            const resetBtn = document.getElementById('resetBtn');
            
            // Elementos de vista previa
            const previewEquipment = document.getElementById('previewEquipment');
            const previewMaintenance = document.getElementById('previewMaintenance');
            const previewResponsible = document.getElementById('previewResponsible');
            const previewPhoto = document.getElementById('previewPhoto');
            const previewSignature = document.getElementById('previewSignature');
            
            // Variables para almacenar datos
            let currentPhoto = null;
            let currentSignature = null;
            let isDrawing = false;
            
            // Actualizar fecha y hora en tiempo real
            function updateDateTime() {
                const now = new Date();
                const options = { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric',
                    hour: '2-digit', 
                    minute: '2-digit', 
                    second: '2-digit' 
                };
                datetime.textContent = now.toLocaleDateString('es-ES', options);
            }
            
            setInterval(updateDateTime, 1000);
            updateDateTime();
            
            // Inicializar la firma
            function initSignaturePad() {
                const ctx = signaturePad.getContext('2d');
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';
                ctx.strokeStyle = '#000';
                
                signaturePad.addEventListener('mousedown', startDrawing);
                signaturePad.addEventListener('mousemove', draw);
                signaturePad.addEventListener('mouseup', stopDrawing);
                signaturePad.addEventListener('mouseout', stopDrawing);
                
                // Soporte para dispositivos táctiles
                signaturePad.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    const touch = e.touches[0];
                    const mouseEvent = new MouseEvent('mousedown', {
                        clientX: touch.clientX,
                        clientY: touch.clientY
                    });
                    signaturePad.dispatchEvent(mouseEvent);
                });
                
                signaturePad.addEventListener('touchmove', function(e) {
                    e.preventDefault();
                    const touch = e.touches[0];
                    const mouseEvent = new MouseEvent('mousemove', {
                        clientX: touch.clientX,
                        clientY: touch.clientY
                    });
                    signaturePad.dispatchEvent(mouseEvent);
                });
                
                signaturePad.addEventListener('touchend', function(e) {
                    e.preventDefault();
                    const mouseEvent = new MouseEvent('mouseup');
                    signaturePad.dispatchEvent(mouseEvent);
                });
            }
            
            function startDrawing(e) {
                isDrawing = true;
                const rect = signaturePad.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                const ctx = signaturePad.getContext('2d');
                ctx.beginPath();
                ctx.moveTo(x, y);
            }
            
            function draw(e) {
                if (!isDrawing) return;
                
                const rect = signaturePad.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                const ctx = signaturePad.getContext('2d');
                ctx.lineTo(x, y);
                ctx.stroke();
            }
            
            function stopDrawing() {
                isDrawing = false;
                updateSignaturePreview();
            }
            
            // Capturar foto (simulado)
            captureBtn.addEventListener('click', function() {
                alert('En una aplicación real, esto activaría la cámara del dispositivo. Para este ejemplo, puede subir una imagen.');
                photoUpload.click();
            });
            
            // Subir foto
            uploadBtn.addEventListener('click', function() {
                photoUpload.click();
            });
            
            photoUpload.addEventListener('change', function(e) {
                if (e.target.files && e.target.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        currentPhoto = event.target.result;
                        updatePhotoPreview();
                    }
                    reader.readAsDataURL(e.target.files[0]);
                }
            });
            
            // Limpiar firma
            clearSignature.addEventListener('click', function() {
                const ctx = signaturePad.getContext('2d');
                ctx.clearRect(0, 0, signaturePad.width, signaturePad.height);
                currentSignature = null;
                updateSignaturePreview();
            });
            
            // Actualizar vistas previas
            function updatePreviews() {
                previewEquipment.textContent = `${equipmentType.options[equipmentType.selectedIndex].text} - ${equipmentId.value}`;
                previewMaintenance.textContent = `${maintenanceType.options[maintenanceType.selectedIndex].text} - ${description.value}`;
                previewResponsible.textContent = responsible.value;
            }
            
            function updatePhotoPreview() {
                if (currentPhoto) {
                    previewPhoto.innerHTML = `<img src="${currentPhoto}" class="preview-image" alt="Foto del equipo">`;
                } else {
                    previewPhoto.textContent = 'No hay foto';
                }
            }
            
            function updateSignaturePreview() {
                if (signaturePad.toDataURL() !== document.createElement('canvas').toDataURL()) {
                    currentSignature = signaturePad.toDataURL();
                    previewSignature.innerHTML = `<img src="${currentSignature}" class="signature-preview" alt="Firma">`;
                } else {
                    previewSignature.textContent = 'No hay firma';
                }
            }
            
            // Event listeners para actualizar vistas previas en tiempo real
            equipmentType.addEventListener('change', updatePreviews);
            equipmentId.addEventListener('input', updatePreviews);
            maintenanceType.addEventListener('change', updatePreviews);
            description.addEventListener('input', updatePreviews);
            responsible.addEventListener('input', updatePreviews);
            
            // Guardar registro
            saveBtn.addEventListener('click', function() {
                if (!equipmentType.value || !equipmentId.value || !maintenanceType.value || !responsible.value) {
                    alert('Por favor complete todos los campos obligatorios.');
                    return;
                }
                
                // En una aplicación real, aquí se enviarían los datos a un servidor
                const maintenanceRecord = {
                    equipmentType: equipmentType.value,
                    equipmentId: equipmentId.value,
                    maintenanceType: maintenanceType.value,
                    description: description.value,
                    responsible: responsible.value,
                    datetime: new Date().toISOString(),
                    photo: currentPhoto,
                    signature: currentSignature
                };
                
                console.log('Registro de mantenimiento:', maintenanceRecord);
                
                alert('¡Mantenimiento registrado correctamente!\n\nEn una aplicación real, estos datos se guardarían en una base de datos.');
                
                // Aquí podrías agregar código para guardar en localStorage o enviar a un servidor
            });
            
            // Limpiar formulario
            resetBtn.addEventListener('click', function() {
                equipmentType.selectedIndex = 0;
                equipmentId.value = '';
                maintenanceType.selectedIndex = 0;
                description.value = '';
                responsible.value = '';
                
                const ctx = signaturePad.getContext('2d');
                ctx.clearRect(0, 0, signaturePad.width, signaturePad.height);
                
                currentPhoto = null;
                currentSignature = null;
                
                updatePreviews();
                updatePhotoPreview();
                updateSignaturePreview();
                
                alert('Formulario limpiado. Puede comenzar un nuevo registro.');
            });
            
            // Inicializar la aplicación
            initSignaturePad();
            
            // Establecer tamaño del canvas de firma
            signaturePad.width = signaturePad.offsetWidth;
            signaturePad.height = signaturePad.offsetHeight;
        });
    </script>
</body>
</html>